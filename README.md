# Подготовка:
## Установка helm в систему:

```
curl -fsSL -o get_helm.sh https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3
chmod 700 get_helm.sh
./get_helm.sh

helm version
version.BuildInfo{Version:"v3.17.0", GitCommit:"301108edc7ac2a8ba79e4ebf5701b0b6ce6a31e4", GitTreeState:"clean", GoVersion:"go1.23.4"}
```

## Создадим свой heml-deploy:
```
helm create bysybox-multitool
```

# Описание:

## После создания получаем такую структуру

---
```plaintext
busybox-multitool/
├── charts
├── Chart.yaml
├── templates/
│   ├── deployment.yaml        # Шаблон для Deployment
│   ├── _helpers.tpl           # Переиспользуемые шаблоны
│   ├── hpa.yaml               # Шаблон для HorizontalPodAutoscaler
│   ├── ingress.yaml           # Шаблон для Ingress
│   ├── NOTES.txt              # Инструкции для пользователя после установки
│   ├── serviceaccount.yaml    # Шаблон для ServiceAccount
│   ├── service.yaml           # Шаблон для Service
│   └── tests/
│       └── test-connection.yaml  # Тесты для проверки подключения
├── values-dev.yaml            # Значения для разработки, добавлен позднее самостоятельно, его нет при создании
├── values-prod.yaml           # Значения для продакшн, добавлен позднее самостоятельно, его нет при создании
└── values.yaml                # Базовые значения
---
```

# Разберем ее

---
Основные файлы которые требуются для работы, остальные файлы могу быть удалены:

  1. Chart.yaml — обязательный файл для описания самого чарта.
  2. templates/deployment.yaml — описание подов и логики приложения.
  3. templates/service.yaml — для экспонирования приложения через сервис.
  4. values.yaml — базовые значения, которые подставляются в манифесты.
---

# Описание файлов:
##  0. **`charts/`**
  Используется для организации зависимостей. Если ваше приложение зависит от других чартов, то эти зависимости будут находиться в каталоге charts/.

  1. Зависимости: Когда ваше приложение зависит от других чарта, вы можете добавить эти чарты в каталог charts/. Это позволяет вам инкапсулировать другие чарты и их зависимости прямо в вашем проекте.
  2. Подкаталог: Чарты, добавленные в этот каталог, могут быть скачаны из других репозиториев, или это могут быть локальные чарты, которые включаются непосредственно в ваш проект.

---
```plaintext
  busybox-multitool/
  ├── charts/
  │   ├── nginx/
  │   └── postgresql/
```
---

##  1. **`Chart.yaml`**
  Этот файл содержит метаданные о чарте. Он необходим для описания версии, названия и описания чарта.

## 2. **`templates/`**
  Это директория, в которой находятся шаблоны манифестов Kubernetes, генерируемые Helm. Манифесты создаются на основе значений, переданных в `values.yaml`.

### 2.1 **`deployment.yaml`**
  Шаблон для создания объекта `Deployment`, который отвечает за развертывание приложения в Kubernetes. В нем указаны контейнеры, образы, команды и другие параметры.

### 2.2 **`_helpers.tpl`**
  Этот файл содержит переиспользуемые шаблоны и функции. Он позволяет создавать общие элементы, такие как имена ресурсов.

### 2.3 **`hpa.yaml`**
  Шаблон для создания объекта **Horizontal Pod Autoscaler** (HPA), который автоматически масштабирует количество реплик в зависимости от использования ресурсов.

### 2.4 **`ingress.yaml`**
  Шаблон для создания объекта **Ingress**, который управляет внешним доступом к приложениям, работающим в Kubernetes. Используется для настройки маршрутизации HTTP(S) запросов.

### 2.5 **`NOTES.txt`**
  Этот файл выводится пользователю после успешного деплоя. Здесь могут быть инструкции или подтверждения о статусе деплоя.

### 2.6 **`serviceaccount.yaml`**
  Шаблон для создания **ServiceAccount** — учетной записи, которая используется для выполнения операций в кластере.

### 2.7 **`service.yaml`**
  Шаблон для создания объекта **Service**, который позволяет другим приложениям или пользователям взаимодействовать с вашим приложением.

### 2.8 **`tests/test-connection.yaml`**
  Этот файл содержит тесты, которые выполняются после установки чарта. Они проверяют, доступно ли ваше приложение или сервис.

##  3. **`tests/test-connection.yaml`**
  Этот файл содержит тесты, которые выполняются после установки чарта. Они проверяют, доступно ли ваше приложение или сервис.

##  4. **`values.yaml`**
  Эти файлы содержат значения, которые подставляются в шаблоны для конфигурации чарта. Они позволяют настроить приложение для разных окружений.

